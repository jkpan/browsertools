<!DOCTYPE html>
<html>
    <head>
      <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height" charset="UTF-8"/>
      <style>
      body {
        margin: 0px;
        height: 100%;
        width: 100%;
        background-color: rgb(0, 128, 0);
      }
      ::-webkit-scrollbar {
        display: none;
      }
      button {
            font-size: 16px;
            background-color: rgb(0, 150, 0);
            color: #00ff00;
            /*margin: 2% 2%;*/
            width: 21%;
            border: 1px solid;
            vertical-align: middle;
          }
      </style>
    </head>
    <body>
                  
        <div id="controlWin" class="controlPart">
            <button id="hymn" onclick="controlParent('hymn')">歌詞</button>
                <button id="hymn_v" onclick="switchVisible('hymn')">V</button>
                <button id="hymn_p" onclick="perspective('hymn')">P</button>
                <button onclick="closeApp('hymn')">x</button>
            <button id="Bible" onclick="controlParent('Bible')">聖經</button>
                <button id="Bible_v" onclick="switchVisible('Bible')">V</button>
                <button id="Bible_p" onclick="perspective('Bible')">P</button>
                <button onclick="closeApp('Bible')">x</button>
            <button id="NIV" onclick="controlParent('NIV')">NIV</button>
                <button id="NIV_v" onclick="switchVisible('NIV')">V</button>
                <button id="NIV_p" onclick="perspective('NIV')">P</button>
                <button onclick="closeApp('NIV')">x</button>
            <button id="ppt_1" onclick="controlParent('ppt_1')">PPT 1</button>
                <button id="ppt_1_v" onclick="switchVisible('ppt_1')">V</button>
                <button id="ppt_1_p" onclick="perspective('ppt_1')">P</button>
                <button onclick="closeApp('ppt_1')">x</button>
            <button id="ppt_2" onclick="controlParent('ppt_2')">PPT 2</button>
                <button id="ppt_2_v" onclick="switchVisible('ppt_2')">V</button>
                <button id="ppt_2_p" onclick="perspective('ppt_2')">P</button>
                <button onclick="closeApp('ppt_2')">x</button>
            <button id="ppt_3" onclick="controlParent('ppt_3')">PPT 3</button>
                <button id="ppt_3_v" onclick="switchVisible('ppt_3')">V</button>
                <button id="ppt_3_p" onclick="perspective('ppt_3')">P</button>
                <button onclick="closeApp('ppt_3')">x</button>
            <button id="info" onclick="controlParent('info')">Info</button>
                <button id="info_v" onclick="switchVisible('info')">V</button>
                <button id="info_p" onclick="perspective('info')">P</button>
                <button onclick="closeApp('info')">x</button>
            <button id="effect" onclick="controlParent('effect')">Effect</button>
                <button id="effect_v" onclick="switchVisible('effect')">V</button>
                <button id="effect_p" onclick="perspective('effect')">P</button>
                <button onclick="closeApp('effect')">x</button>
            <button id="time" onclick="controlParent('time')">Time</button>
                <button id="time_v" onclick="switchVisible('time')">V</button>
                <button id="time_p" onclick="perspective('time')">P</button>
                <button onclick="closeApp('time')">x</button>
        <hr size="8" width="100%" color="#007000">
            <button id="sub" onclick="controlParent('dBoard')">dboard</button>
                <button id="sub_v" onclick="switchVisible('dBoard')">V</button>
                <button id="sub_p" onclick="perspective('dBoard')">P</button>
                <button onclick="closeApp('dBoard')">x</button>
            <button id="sub" onclick="controlParent('sub')">整合</button>
                <button id="sub_v" onclick="switchVisible('sub')">V</button>
                <button id="sub_p" onclick="perspective('sub')">P</button>
                <button onclick="closeApp('sub')">x</button>
        <hr size="8" width="100%" color="#007000">
            <button onclick="reloadState()">reload</button>
        </div>
      
    </body>
</html>

<script type="text/javascript" charset="UTF-8">

function closeApp(keyname) {
    window.opener.closeApp(keyname);
    reloadState();
}

function reloadState() {
    let stateArray = window.opener.getElmState();
    console.log(stateArray);
    for (let key in stateArray) {
        console.log(key);
        let b = document.getElementById(key);
        let b_v = document.getElementById(key + '_v');
        switch(stateArray[key]) {
            case -1:
                b.style.background = "transparent";
                b_v.style.background = "transparent";
                break;
            case 0:
                b.style.background = "rgb(0,0,0)";
                b_v.style.background = "transparent";
                break;
            case 1:
                b.style.background = "rgb(0,0,0)";
                b_v.style.background = "rgb(0,0,0)";
                break;
        }
    }
}

function controlParent(keyname) {
    window.opener.spot2iframe(keyname);
    reloadState();
}

function switchVisible(keyname) {
    window.opener.switchVisible4iframe(keyname);
    reloadState();
}

function perspective(keyname) {
    window.opener.perspective4iframe(keyname);
    reloadState();
}


reloadState();

</script>
