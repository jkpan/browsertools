<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height" charset="UTF-8"/>
<style>
body {
  color: rgb(0,255,0);
  margin: 0% 0%;
  height: 100%;
  width: 100%;
  background-color: rgb(0, 128, 0);
  /* transparent; border: 2px solid rgb(0, 255, 0);*/
}
.wrapper {
  
  display: grid;
  gap: 0px;
    
  grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
  grid-template-rows:    1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr;

  width: 100%;
  height: 100vh;

}
.full {    
  grid-column: 1 / 25;
  grid-row: 1 / 25;
  user-select: none;
  border: none;
}
.reload {

  grid-column: 24 / 25;
  grid-row: 22 / 23;
  border: none;
  opacity: 25%;

  font-size: 24px;
  background-color: rgb(0, 150, 0);
  color: #00ff00;
  
  vertical-align: middle;

}
.ui {
    grid-column: 2 / 24;
    grid-row: 2 / 24;
}

::-webkit-scrollbar {
  display: none;
}
textarea {
  border:2px solid rgb(0, 128, 0);
  border-radius: 2px;
  border-color: rgb(0, 255, 0);
  margin: 1%;
  outline: none;
  padding: 0px;
  box-sizing: border-box;
  background: rgb(0, 150, 0);
  color: rgb(0, 255, 0);
  width: 96%;
}
textarea:focus {
  border:2px solid;
  border-color: rgb(0, 255, 0);
  box-shadow: 0 0 8px 0 rgb(0, 255, 0);
  background: rgb(0, 150, 0);
  color: rgb(0, 255, 0);    
}
.okbutton {
  font-size: 24px;
  background-color: rgb(0, 150, 0);
  color: #00ff00;
  margin: 2% 2%;
  width: 50%;
  border: 2px solid;
  vertical-align: middle;
}
input[type=file] {
  border:2px solid;
  border-color: rgb(0, 255, 0);
  box-shadow: 0 0 8px 0 rgb(0, 255, 0);
  background: rgb(0, 150, 0);
  background-color: rgb(0, 150, 0);
  color: rgb(0, 255, 0);
}
img {
  display: block;
  margin: 0 auto;
}
a {
  color: #00ff00;
}
</style>
</head>
    <body>

      <!--hr size="8" width="100%" color="#00ff00"/-->    

      <div class="wrapper">
        
        <!--embed-->
        <iframe width="100%" height="100%" hidden="true" class="full" id="pdf-viewer" type="application/pdf"></iframe>
        <iframe width="100%" height="100%" hidden="true" class="full" id="web"></iframe>
        <button class="reload" hidden="true" id="reload" type="button" onclick="reload()">R</button>
        <video class="full" id="vsrc" width="100%" height="100%" controls="controls" hidden="true"></video>
        <div class="full" id="image_container" hidden="true"></div>

        <div class="ui" id="ui">
          嵌入Google簡報, Canva簡報, Youtube影片...
          <textarea id="ppt_url" name="mytext" rows="5"></textarea>
            <script type="text/javascript" charset="UTF-8">
              //document.getElementById("ppt_url").value = "https://docs.google.com/presentation/d/e/2PACX-1vTACMqqdWpFOdQYp1x518Gl7Oy_AQdSHFsSewEcVFOF9LkxKO6d7SCTJl5mkgqPg291kcSEI9vPNq4b/embed?start=false&loop=false&rm=minimal";
              //document.getElementById("ppt_url").value = "&rm=minimal";
              //document.getElementById("ppt_url").select();
              function urlGo() {
                let value = document.getElementById("ppt_url").value;
                value = value.trim();
                if (value.length == 0) return;

                document.getElementById("ui").hidden = true;
                document.getElementById("web").hidden = false;
                document.getElementById("web").src = value;
                document.getElementById("reload").hidden = false;

                //window.location.href = value;
                //document.querySelector('body').style.background = 'transparent';
              }
              function iframeGo() {

                document.querySelector('body').style.background = 'transparent';

                document.getElementById("ui").hidden = true;

              
                let value = document.getElementById("ppt_url").value;
                document.querySelector('body').innerHTML = value;
                //let div = document.getElementById("ppt_container");
                //div.innerHTML = value;
                //div.hidden = false;
              }
              function reload() {
                let d = document.getElementById("web");
                document.getElementById("web").src = d.src;
              }

            </script>
          <br/>
          <button class="okbutton" type="button" onclick="urlGo()">OK</button>
          <!--button class="okbutton" type="button" onclick="iframeGo()">OK (embedded whole iframe)</button-->
          <br/>
            <a href="javascript:googleSlidesRemoveBar()"> * Google簡報若不要出現下方功能bar, '嵌入'用的url後方要加上'&rm=minimal'</a> <br/>
            * Google簡報要打開speaker notes按's'<br/>
            * Canva簡報, 檢查'嵌入'用的url後方有無"view?embed", 沒有就自己加上<br/>
          <hr size="4" width="100%" color="#00ff00"/>
          本機檔案<br/>
          <P></P>
            <button class="okbutton" type="button" onclick="openFile('filepdf')">PDF</button>
            <input id="filepdf" type="file" hidden="true" accept=".pdf" onchange="selectPDF(event)"/><br/>
          <P></P>
            <button class="okbutton" type="button" onclick="openFile('fileimage')">Image</button>
            <input id="fileimage" type="file" hidden="true" onchange="selectImg(event)"/><br/>
          <P></P>
            <button class="okbutton" type="button" onclick="openFile('filevideo')">Video</button>
            <input id="filevideo" type="file" hidden="true" accept="video/*" onchange="playVideo(event)"/>
          
        </div>
      </div>

    </body>
</html>
  
<script type="text/javascript" charset="UTF-8">

function googleSlidesRemoveBar() {
  let value = document.getElementById("ppt_url").value;
  value = value.trim();
  value += '&rm=minimal';
  document.getElementById("ppt_url").value = value;
}

function openFile(elmid) {
  document.getElementById(elmid).click();
}

function selectImg(event) {
  //document.style.opacity = '0.0';
  //document.style.opacity = "0.0";
  // 取得所選檔案
  document.querySelector('body').style.background = 'transparent';

  var selectedFile = event.target.files[0];
			
			// 檢查檔案是否為圖片檔
			if (!selectedFile.type.match('image.*')) {
				alert("選擇的檔案不是圖片檔！");
				return;
			}
      
      let ui = document.getElementById("ui");
      ui.hidden = true;

			// 讀取檔案並將其轉換成Data URL
			var reader = new FileReader();
			reader.onload = function(event) {
				var imageUrl = event.target.result;
        let img = new Image();
        img.src = imageUrl;
        img.onload = function() {
          var width = img.width;
          var height = img.height;//window.location.href = imageUrl; return;
          let div = document.getElementById("image_container");
          div.hidden = false;
          if (width > height) 
            div.innerHTML = '<img width="100%" height="auto" aligh="center" src="' + imageUrl + '" />';
          else 
            div.innerHTML = '<img width="auto" height="100%" aligh="center" src="' + imageUrl + '" />';
        };
				
			};
			reader.readAsDataURL(selectedFile);
      
}

function selectPDF(event) {

  document.querySelector('body').style.background = 'transparent';

  let ui = document.getElementById("ui");
  ui.hidden = true;

  const file = event.target.files[0];//input.files[0];
	const fileURL = URL.createObjectURL(file);

  //let viewer = document.getElementById('pdf-viewer');
	//viewer.setAttribute('src', fileURL);
  //viewer.hidden = false;

  window.location.href = fileURL;

}

function playVideo(event) {

  document.querySelector('body').style.background = 'transparent';

  let ui = document.getElementById("ui");
  ui.hidden = true;

  const file = event.target.files[0];
  const videoURL = URL.createObjectURL(file);

  const video = document.getElementById("vsrc");
  video.src = videoURL;
  video.hidden = false;

  //window.location.href = videoURL;

}

window.addEventListener('message', (e) => {

  if (e.data.trim().length < 2) reutrn;

  const jsonData = JSON.parse(e.data);

  if (!jsonData.url) return;
  if (jsonData.url.trim().length == 0) return;
  document.getElementById("ppt_url").value = jsonData.url.trim();
  //urlGo();

}, false);

function toObj() {
  if (!document.getElementById("web").hidden)
    return { "url": document.getElementById("web").src };
  let _url = document.getElementById("ppt_url").value.trim();
  return { "url": _url };
}

/*
edit:
https://www.canva.com/design/DAFY964Fw6Q/h7INsnBvo-q1ZBllt6OeCg/edit?utm_content=DAFY964Fw6Q&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton
play:
https://www.canva.com/design/DAFY964Fw6Q/Q3H7T_HsNl7OQVQMtVutAw/view?utm_content=DAFY964Fw6Q&utm_campaign=designshare&utm_medium=link&utm_source=publishsharelink
embedded:
<div style="position: relative; width: 100%; height: 0; padding-top: 56.2500%;
 padding-bottom: 0; box-shadow: 0 2px 8px 0 rgba(63,69,81,0.16); margin-top: 1.6em; margin-bottom: 0.9em; overflow: hidden;
 border-radius: 8px; will-change: transform;">
  <iframe loading="lazy" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; border: none; padding: 0;margin: 0;"
    src="https:&#x2F;&#x2F;www.canva.com&#x2F;design&#x2F;DAFY964Fw6Q&#x2F;view?embed" allowfullscreen="allowfullscreen" allow="fullscreen">
  </iframe>
</div>
黃玉馨 設計的 <a href="https:&#x2F;&#x2F;www.canva.com&#x2F;design&#x2F;DAFY964Fw6Q&#x2F;view?utm_content=DAFY964Fw6Q&amp;utm_campaign=designshare&amp;utm_medium=embeds&amp;utm_source=link" target="_blank" rel="noopener">莊稼多工人少</a>
=>
https://www.canva.com/design/DAFY964Fw6Q/view?embed
embedded:
https://www.canva.com/design/DAFY964Fw6Q/view
+?embed
=
https://www.canva.com/design/DAFY964Fw6Q/view?embed
*/
</script>
