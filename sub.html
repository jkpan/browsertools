<script type="text/javascript" charset="UTF-8"> 

/*
function getIframeWindow(iframe_object) {

  var doc;

  if (iframe_object.contentWindow) {
    console.log('1');
    return iframe_object.contentWindow;
  }

  if (iframe_object.window) {
    console.log('2');
    return iframe_object.window;
  }

  if (!doc && iframe_object.contentDocument) {
    doc = iframe_object.contentDocument;
    console.log('3');
  } 
  
  if (!doc && iframe_object.document) {
    doc = iframe_object.document;
    console.log('4');
  }

  if (doc && doc.defaultView) {
    console.log('5');
   return doc.defaultView;
  }

  if (doc && doc.parentWindow) {
    console.log('6');
    return doc.parentWindow;
  }

  console.log('7');
  return undefined;
}
*/

var funcInterval;
var intervalType = 0;

function startRestoreInterval() {

  if (funcInterval) {
    stopTabInterval();
    return;
  }
  funcInterval = window.setInterval(restoreTabFromLocal, 500);
  intervalType = -1;

  var b = document.getElementById('ox');
  b.textContent = 'x';

  //document.getElementById("frame_1").contentWindow.startRestoreInterval();
  //
  //var s1 = document.getElementById('frame_1');
  //s1.textContent.startRestoreInterval();
  //s1.contentWindow.sub_function();
  //s1.contentWindow.startRestoreInterval();
  
  /*
  var el = document.getElementById('frame_1');
  var frame_win = getIframeWindow(el);
  console.log(frame_win);
  if (frame_win) {
    console.log('run startRestoreInterval');
    frame_win.sub_function();//startRestoreInterval();
  }

  console.log('run end');
  */
}

function stopTabInterval() {
  if (funcInterval) clearInterval(funcInterval);
  funcInterval = null;
  intervalType = 0;

  var b = document.getElementById('ox');
  b.textContent = 'o';
}

var tab;
function saveTab2Local() {
  let key = 'save tab';
  let value = '' + tab;
  localStorage.setItem(key, value);
}

function restoreTabFromLocal() {
  //console.log('restoreTabFromLocal');
  let key = 'save tab';
  let value = localStorage.getItem(key);
  if (!value) return;
  value = value.trim();
  if (value && value.length == 0) return;
  let _tab = parseInt(value);
  if (_tab == tab) return;
  tab = _tab;
  _switchFunction(_tab);
}

</script>

<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8"/>
  <style>
  body {
    margin: 0px;
    height: 100%;
    width: 100%;
    background-color: green;
  }
  .wrapper {
    display: grid;
    gap: 0px;
    grid-template-columns: 1fr 1fr 1fr 1fr 28fr;
    grid-template-rows: 1fr 31fr;
    width: 100%;
    height: 100vh;
  }
  .one {
    grid-column: 1 / 2;
    grid-row: 1 / 2;
  }
  .two {
    grid-column:  2 / 3;
    grid-row: 1 / 2;
  }
  .three {
    grid-column: 3 / 4;
    grid-row: 1 / 2;
  }
  .four {
    grid-column: 4 / 5;
    grid-row: 1 / 2;
  }
  .content {
    grid-column: 1 / 6;
    grid-row: 2 / 3;
  }
  .button {
    font-size: 24px;
    background-color:transparent;
    color: #00ff00;
    width:100%;
    height:100%;
    border: none;
    vertical-align: middle;
  }
  </style>
</head>
<body>

<div class="wrapper" style="background-color: green; opacity: 1.0;">
  <div class="one" style="background-color: green;margin: 0px;opacity: 1.0;">
      <button type="button" class="button" onclick="switchFunction(1)">.</button>
  </div>
  <div class="two" style="background-color: green;margin: 0px;opacity: 1.0;">
      <button type="button" class="button" onclick="switchFunction(2)">..</button>
  </div>
  <div class="three" style="background-color: green;margin: 0px;opacity: 1.0;">
      <button type="button" class="button" onclick="switchFunction(3)">.</button>
  </div>
  <div class="four" style="background-color: green;margin: 0px;opacity: 1.0;">
    <button id="ox" type="button" class="button" onclick="startRestoreInterval()">o</button>
  </div>
  <div id="content_txt" class="content" style="background-color: cyan;margin: 0px;opacity: 1.0;">
      <iframe id="frame_1" frameborder="0" width="100%" height="100%" align="left" src="subtitle.html"></iframe>
  </div>
  <div id="content_txt2" class="content" style="background-color: yellow;margin: 0px;opacity: 1.0;">
      <iframe id="frame_2" frameborder="0" width="100%" height="100%" align="right" src="subtitle_b.html"></iframe>
  </div>
  <div id="content_txt3" class="content" style="background-color: magenta;margin: 0px;opacity: 1.0;">
    <iframe id="frame_3" frameborder="0" width="100%" height="100%" align="right" src="effect.html"></iframe>
  </div>
</div>
</body>
</html>

<script type="text/javascript" charset="UTF-8">

function switchFunction(idx) {
  tab = idx;
  _switchFunction(idx);
  saveTab2Local();
}

function _switchFunction(idx) {
      
      document.getElementById('content_txt').hidden = true;
      document.getElementById('content_txt2').hidden = true;
      document.getElementById('content_txt3').hidden = true;
      
      

      switch(idx) {
        case 1:
          document.getElementById('content_txt').hidden = false;
          document.getElementById('frame_1').focus();
          break;
        case 2:
          document.getElementById('content_txt2').hidden = false;
          document.getElementById('frame_2').focus();
          break;
        case 3:
          document.getElementById('content_txt3').hidden = false;
          document.getElementById('frame_3').focus();
          break;
      }
    
}

tab = 1
_switchFunction(tab);

</script>
