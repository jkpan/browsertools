<!DOCTYPE html>
<script type="text/javascript" charset="UTF-8">

  var tool_song = 'subtitle.html';
  var tool_Bible = 'subtitle_b.html';
  var tool_index = 'tools.html';//'effect.html';
  
  const URL_HELP = 'https://docs.google.com/presentation/d/e/2PACX-1vTACMqqdWpFOdQYp1x518Gl7Oy_AQdSHFsSewEcVFOF9LkxKO6d7SCTJl5mkgqPg291kcSEI9vPNq4b/embed?start=false&loop=false';
  //var demo = 'https://docs.google.com/presentation/d/e/2PACX-1vQF2IcPH9tSgDnQVPQm_EbE_ZXAHZj-9lX4-Gb9zsdAhlyiC8LhQrTwHs0f-5OZ2g/embed?start=false&loop=false&delayms=3000';
  
  var ppt = [URL_HELP,
             '', 
             '', 
             ''];
  var pptype = [0, 0, 0, 0];
  
</script>
<html>
<head>
  <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height" charset="UTF-8"/>
  <!--meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8"/-->
  <style>
  body {
    margin: 0px;
    height: 100%;
    width: 100%;
    background-color: green;
  }
  ::-webkit-scrollbar {
    display: none;
  }
  input[type=text] {
        width:60%;
        border:2px solid #0d0;
        border-radius: 4px;
        margin: 2% 2%;
        outline: none;
        padding: 8px;
        box-sizing: border-box;
  }
  input[type=text]:focus {
        border-color: #00ff00;
        box-shadow: 0 0 8px 0 #007000;
  }
  ::selection {
    color: #007000;
    background: #00ff00;
    border-color: #00ff00;
    box-shadow: 0 0 8px 0 #007000;
  }
  .select {
            font-size: 28px;
            height: 40px;
            border: none;
            border-radius: 3px;
            vertical-align: middle;
            margin: 2% 2%;
            color: #00ff00;

        }
  .wrapper {
    display: grid;
    gap: 0px;
    grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr 22fr 1fr 1fr 1fr;
    grid-template-rows: 1fr 63fr;
    width: 100%;
    height: 100vh;
  }
  .one {
    grid-column: 1 / 2;
    grid-row: 1 / 2;
  }
  .two {
    grid-column:  2 / 3;
    grid-row: 1 / 2;
  }
  .three {
    grid-column: 3 / 4;
    grid-row: 1 / 2;
  }
  .four {
    grid-column: 4 / 5;
    grid-row: 1 / 2;
  }
  .five {
    grid-column: 5 / 6;
    grid-row: 1 / 2;
  }
  .six {
    grid-column: 6 / 7;
    grid-row: 1 / 2;
  }
  .seven {
    grid-column: 7 / 8;
    grid-row: 1 / 2;
  }
  .eight {
    grid-column: 8 / 9;
    grid-row: 1 / 2;
  }
  .nine {
    grid-column: 9 / 10;
    grid-row: 1 / 2;
  }
  .ten {
    grid-column: 10 / 11;
    grid-row: 1 / 2;
  }
  .eleven {
    grid-column: 11 / 12;
    grid-row: 1 / 2;
  }

  .content {
    grid-column: 1 /12;
    grid-row: 2 / 3;
  }
  
  .fullcontent {
    grid-column: 1 /12;
    grid-row: 1 / 3;
  }

  .button {
    font-size: 24px;
    background-color:transparent;
    color: #00ff00;
    width:100%;
    height:100%;
    border: none;
    vertical-align: middle;
  }
  .okbutton {
      font-size: 24px;
      background-color:green;
      color: #00ff00;
      width: 100px;
      height: 75px;
      border: none;
  }
  .spliter {
    display: grid;
    gap: 0px;
    grid-template-columns: 2fr 1fr;
    grid-template-rows: 2fr 1fr;
    width: 100%;
    height: 100%;
  }
  .splitertop {
    grid-column: 1 / 3;
    grid-row: 1 / 2;
  }
  .spliterbottom {
    grid-column: 1 / 3;
    grid-row: 2 / 3;
  }

  .spliterleft {
    grid-column: 1 / 2;
    grid-row: 1 / 3;
  }
  .spliterright {
    grid-column: 2 / 3;
    grid-row: 1 / 3;
  }

  .spliterall {
    grid-column: 1 / 3;
    grid-row: 1 / 3;
  }


  </style>
</head>
<body>

<div class="wrapper" style="background-color: #007000; opacity: 1.0;">
  
  <!-- 歌詞 -->
  <div id="div_song" class="one" style="background-color: #007000;margin: 0px;opacity: 1.0;">
      <button type="button" class="button" onclick="switchFunction('song')">.</button>
  </div>
  
  <!-- 聖經 -->
  <div id="div_Bible" class="two" style="background-color: #007000;margin: 0px;opacity: 1.0;">
      <button type="button" class="button" onclick="switchFunction('Bible')">.</button>
  </div>
  
  <!-- index -->
  <div id="div_effect" class="three" style="background-color: #007000;margin: 0px;opacity: 1.0;">
      <button type="button" class="button" onclick="switchFunction('effect')">.</button>
  </div>
  
  <!-- index -->
  <div id="div_news" class="four" style="background-color: #007000;margin: 0px;opacity: 1.0;">
    <button type="button" class="button" onclick="switchFunction('news')">.</button>
  </div>

  <!-- 輸入 -->
  <div id="content_input" class="content" style="background-color: green;margin: 0px;opacity: 1.0;">
    <br/>
    <input type="text" id="ppt_url" name="input_url" value="" 
           style="box-shadow: 0px 0px 0px #00ff00;border:1px solid #00ff00;color: #00ff00;background-color: green;margin: 10px;opacity: 1.0;" 
           placeholder="" />
    <script type="text/javascript" charset="UTF-8">
        document.getElementById("ppt_url").value = ppt[0];
    </script>
    <br/>
    <select id="Bibletype" style="box-shadow: 0px 0px 0px #00ff00;border:1px solid #00ff00;color: #00ff00;background-color: green;margin: 10px;opacity: 1.0;">
      <option value="0" selected>投影片</option>
      <option value="1">投影片左 經文右</option>
      <option value="2">投影片中 經文右</option>
      <option value="3">投影片上 經文下</option>
      <option value="4">投影片中 經文下</option>
    </select>
    <button class="okbutton" type="button" onclick="slideGo()">OK</button>
    <br/>
  </div>

  <!-- 投影片1 -->
  <div id="div_slide1" class="five" style="background-color: #007000;margin: 0px;opacity: 1.0;">
    <button type="button" class="button" onclick="switchFunction('slide1')">:</button>
  </div>
  
  <!-- 投影片2 -->
  <div id="div_slide2" class="six" style="background-color: #007000;margin: 0px;opacity: 1.0;">
    <button type="button" class="button" onclick="switchFunction('slide2')">:</button>
  </div>
  
  <!-- 投影片3 -->
  <div id="div_slide3" class="seven" style="background-color: #007000;margin: 0px;opacity: 1.0;">
    <button type="button" class="button" onclick="switchFunction('slide3')">:</button>
  </div>

  <!-- Gap -->
  <div id="div_empty" class="eight" style="background-color: #007000;margin: 0px;opacity: 1.0;"></div>

  <!-- full screen CONTENT -->
  <!-- 歌詞 -->
  <div id="content_song" class="content" style="background-color: cyan;margin: 0px;opacity: 1.0;">
    <iframe id="frame_song" frameborder="0" width="100%" height="100%" align="left" src=""></iframe>
      <script type="text/javascript" charset="UTF-8">
        document.getElementById("frame_song").src = tool_index;
      </script>
  </div>

  <!-- 聖經 -->
  <div id="content_Bible" class="content" style="background-color: yellow;margin: 0px;opacity: 1.0;">
    <iframe id="frame_Bible" frameborder="0" width="100%" height="100%" align="right" src=""></iframe>
      <script type="text/javascript" charset="UTF-8">
        document.getElementById("frame_Bible").src = tool_index;
      </script>
  </div>

  <!-- Effect -->
  <div id="content_effect" class="content" style="background-color: magenta;margin: 0px;opacity: 1.0;">
    <iframe id="frame_effect" frameborder="0" width="100%" height="100%" align="right" src=""></iframe>
    <script type="text/javascript" charset="UTF-8">
      document.getElementById("frame_effect").src = tool_index;
    </script>
  </div>

  <!-- News -->
  <div id="content_news" class="content" style="background-color: magenta;margin: 0px;opacity: 1.0;">
    <iframe id="frame_news" frameborder="0" width="100%" height="100%" align="right" src=""></iframe>
    <script type="text/javascript" charset="UTF-8">
      document.getElementById("frame_news").src = tool_index;
    </script>
  </div>

  <!-- 投影片1 -->
  <div id="content_slide_1" class="content" style="background-color: black;margin: 0px;opacity: 1.0;">
    <div class="spliter" style="background-color: black;margin: 0px;opacity: 1.0;">
      <iframe class="splitertop"    id="frame_slide_1" src="" frameborder="0" width="100%" height="100%" allowfullscreen="false" mozallowfullscreen="false" webkitallowfullscreen="false"></iframe>
      <iframe class="spliterbottom" id="frame_Bible_1" frameborder="0" width="100%" height="100%" align="right" src=""></iframe>
    </div>
  </div>

  <!-- 投影片2 -->
  <div id="content_slide_2" class="content" style="background-color: black;margin: 0px;opacity: 1.0;">
    <div class="spliter" style="background-color: black;margin: 0px;opacity: 1.0;">
      <iframe class="splitertop" id="frame_slide_2" src="" frameborder="0" width="100%" height="100%" allowfullscreen="false" mozallowfullscreen="false" webkitallowfullscreen="false"></iframe>
      <iframe class="spliterbottom" id="frame_Bible_2" frameborder="0" width="100%" height="100%" align="right" src=""></iframe>
    </div>
  </div>

  <!-- 投影片3 -->
  <div id="content_slide_3" class="content" style="background-color: black;margin: 0px;opacity: 1.0;">
    <div class="spliter" style="background-color: black;margin: 0px;opacity: 1.0;">
      <iframe class="splitertop" id="frame_slide_3" src="" frameborder="0" width="100%" height="100%" allowfullscreen="false" mozallowfullscreen="false" webkitallowfullscreen="false"></iframe>
      <iframe class="spliterbottom" id="frame_Bible_3" frameborder="0" width="100%" height="100%" align="right" src=""></iframe>      
    </div>
  </div>
  
  <div id="div_layout" class="nine" style="margin: 0px;opacity: 1.0;">
    <button id="layoutBtn" type="button" class="button" onclick="somelayout()">+</button>    
  </div>

  <div id="div_fs" class="ten" style="margin: 0px;opacity: 1.0;">
    <button type="button" class="button" onclick="fullScreen()">[]</button>
    <!--script type="text/javascript" charset="UTF-8"></script-->
  </div>

  <div id="div_ox" class="eleven" style="margin: 0px;opacity: 1.0;">
    <button id="oxBtn" type="button" class="button" onclick="startRestoreInterval()">o</button>
  </div>

</div>



</body>
</html>

<script type="text/javascript" charset="UTF-8">

function fullScreen() {

  if (document.getElementById('content_song').className == 'fullcontent') {
    document.getElementById('content_song').className = "content";
    document.getElementById('content_Bible').className = "content";
    document.getElementById('content_effect').className = "content";
    document.getElementById('content_news').className = "content";
        
    document.getElementById('content_slide_1').className = "content";
    document.getElementById('content_slide_2').className = "content";
    document.getElementById('content_slide_3').className = "content";
    
  } else {
    document.getElementById('content_song').className = "fullcontent";
    document.getElementById('content_Bible').className = "fullcontent";
    document.getElementById('content_effect').className = "fullcontent";
    document.getElementById('content_news').className = "fullcontent";
        
    document.getElementById('content_slide_1').className = "fullcontent";
    document.getElementById('content_slide_2').className = "fullcontent";
    document.getElementById('content_slide_3').className = "fullcontent";
  }
  
  _switchFunction(tab);
  
  /*
  let elm = document.getElementById('div_fs');
  elm.parentNode.appendChild(elm);
  elm = document.getElementById('div_layout');
  elm.parentNode.appendChild(elm);
  elm = document.getElementById('div_ox');
  elm.parentNode.appendChild(elm);
  */
}

function somelayout() {

  if (!funcInterval) 
    saveAction2Local(0);
  
  let idx = 0;
  let type = 0;

  switch (tab) {
    case 'slide1': idx = 1; break;
    case 'slide2': idx = 2; break;
    case 'slide3': idx = 3; break;
    default: return;
  }
  
  //for (let idx = 1;idx<=3;idx++) {
    let elementMain = document.getElementById('frame_slide_' + idx);
    let elementSub = document.getElementById('frame_Bible_' + idx);

    switch(pptype[idx]) {
    case 0: return;
    case 1: 
      elementSub.hidden = !elementSub.hidden;
      if (elementSub.hidden) {
        elementMain.className = 'spliterall';
      } else {
        elementMain.className = 'spliterleft';
      }
      break;
    case 2:   
      elementSub.hidden = !elementSub.hidden;
      break;
    case 3: 
      elementSub.hidden = !elementSub.hidden;
      if (elementSub.hidden) {
        elementMain.className = 'spliterall';
      } else {
        elementMain.className = 'splitertop';
      }
      break;
    case 4: 
      elementSub.hidden = !elementSub.hidden;
      break;
    }
  //}

  _switchFunction(tab);
 
}


function slideGo() {

  let value = document.getElementById("ppt_url").value;//String.fromCodePoint(0x1F604);
  if (value.length == 0) return;
  
  let sel = document.getElementById('Bibletype');
  let type = parseInt(sel.options[sel.options.selectedIndex].value, 10); //alert('sel : ' + type);

  let idx = 0;

  if (tab == 'slide1') 
    idx = 1;
  else if (tab == 'slide2') 
    idx = 2;
  else if (tab == 'slide3') 
    idx = 3;
  else 
    return;

  ppt[idx] = value;
  pptype[idx] = type;
  
  //let _main = 'slide' + idx + '_main';
  //let _sub =  'slide' + idx + '_sub';

  let elementMain = document.getElementById('frame_slide_' + idx);
  let elementSub = document.getElementById('frame_Bible_' + idx);

  elementMain.src = ppt[idx];

  switch(pptype[idx]) {
    case 0:
      elementMain.className = 'spliterall';
      elementSub.hidden = true;
      elementSub.src = '';
      break;
    case 1:
      elementMain.className = 'spliterleft';
      elementSub.hidden = false;
      elementSub.src = tool_Bible;
      elementSub.className = 'spliterright';
      break;
    case 2:
      elementMain.className = 'spliterall';
      elementSub.hidden = false;
      elementSub.src = tool_Bible;
      elementSub.className = 'spliterright';
      break;
    case 3:
      elementMain.className = 'splitertop';
      elementSub.hidden = false;
      elementSub.src = tool_Bible;
      elementSub.className = 'spliterbottom';
      break;
    case 4:
      elementMain.className = 'spliterall';
      elementSub.hidden = false;
      elementSub.src = tool_Bible;
      elementSub.className = 'spliterbottom';
      break;
  }

  _switchFunction(tab);//'slide' + idx);
  //document.getElementById('frame_slide' + idx).focus();

}

var action = '';
var tab;
var funcInterval;
var intervalType = 0;

function startRestoreInterval() {

  if (funcInterval) {
    stopTabInterval();
    return;
  }

  funcInterval = window.setInterval(restoreTabFromLocal, 500);
  intervalType = -1;

  var b = document.getElementById('oxBtn');
  b.textContent = 'x';

  if (document.getElementById("frame_song").contentWindow)
    document.getElementById("frame_song").contentWindow.postMessage('x', '/');

  if (document.getElementById("frame_Bible").contentWindow)
    document.getElementById("frame_Bible").contentWindow.postMessage('x', '/');


  if (document.getElementById("frame_Bible_1").contentWindow)
    document.getElementById("frame_Bible_1").contentWindow.postMessage('x', '/');
  
  if (document.getElementById("frame_Bible_2").contentWindow)
    document.getElementById("frame_Bible_2").contentWindow.postMessage('x', '/');
    
  if (document.getElementById("frame_Bible_3").contentWindow)
    document.getElementById("frame_Bible_3").contentWindow.postMessage('x', '/');

  if (document.getElementById("frame_effect").contentWindow)
    document.getElementById("frame_effect").contentWindow.postMessage('x', '/');
  if (document.getElementById("frame_news").contentWindow)
    document.getElementById("frame_news").contentWindow.postMessage('x', '/');

  
  if (document.getElementById("frame_slide_1").contentWindow)
    document.getElementById("frame_slide_1").contentWindow.postMessage('x', '/');

  if (document.getElementById("frame_slide_2").contentWindow)
    document.getElementById("frame_slide_2").contentWindow.postMessage('x', '/');

  if (document.getElementById("frame_slide_3").contentWindow)
    document.getElementById("frame_slide_3").contentWindow.postMessage('x', '/');
  

}

function stopTabInterval() {
  if (funcInterval) clearInterval(funcInterval);
  funcInterval = null;
  intervalType = 0;

  var b = document.getElementById('oxBtn');
  b.textContent = 'o';

  if (document.getElementById("frame_song").contentWindow)
    document.getElementById("frame_song").contentWindow.postMessage('o', '/');

  if (document.getElementById("frame_Bible").contentWindow)
    document.getElementById("frame_Bible").contentWindow.postMessage('o', '/');

  if (document.getElementById("frame_Bible_1").contentWindow)
    document.getElementById("frame_Bible_1").contentWindow.postMessage('o', '/');
  
  if (document.getElementById("frame_Bible_2").contentWindow)
    document.getElementById("frame_Bible_2").contentWindow.postMessage('o', '/');

  if (document.getElementById("frame_Bible_3").contentWindow)
    document.getElementById("frame_Bible_3").contentWindow.postMessage('o', '/');

  if (document.getElementById("frame_Bible_3").contentWindow)
    document.getElementById("frame_Bible_3").contentWindow.postMessage('o', '/');

  if (document.getElementById("frame_effect").contentWindow)
    document.getElementById("frame_effect").contentWindow.postMessage('o', '/');
  if (document.getElementById("frame_news").contentWindow)
    document.getElementById("frame_news").contentWindow.postMessage('o', '/');


  if (document.getElementById("frame_slide_1").contentWindow)
    document.getElementById("frame_slide_1").contentWindow.postMessage('o', '/');

  if (document.getElementById("frame_slide_2").contentWindow)
    document.getElementById("frame_slide_2").contentWindow.postMessage('o', '/');

  if (document.getElementById("frame_slide_3").contentWindow)
    document.getElementById("frame_slide_3").contentWindow.postMessage('o', '/');


}

function saveAction2Local(act) {
  
  var date = new Date();

  let h = date.getHours() % 12;
  let min = date.getMinutes();
  let s = date.getSeconds();
  let ms = date.getMilliseconds();

  let key = 'save act';
  let value = act + ' ' + h + ':' + min +':' + s + ':' + ms;
  localStorage.setItem(key, value);

}

function saveTab2Local() {
  let key = 'save tab';
  let value = '' + tab;
  localStorage.setItem(key, value);
}

function restoreTabFromLocal() {

  let actkey = 'save act';
  let actvalue = localStorage.getItem(actkey);
  if (actvalue && actvalue.trim().length > 0) {
    actvalue = actvalue.trim();
    if (action != actvalue) {
      somelayout();
    }
    action = actvalue;
  } 

  let key = 'save tab';
  let value = localStorage.getItem(key);
  
  if (!value) return;
  
  value = value.trim();
  
  if (value && value.length == 0) return;
  
  let _tab = value;//parseInt(value);

  if (_tab == tab) return;

  tab = _tab;
  _switchFunction(_tab);

}

function switchFunction(idx) {
  tab = idx;
  _switchFunction(idx);
  if (keylock) return;
  saveTab2Local();
}

function _switchFunction(idx) {
      
      document.getElementById('content_song').hidden = true;
      document.getElementById('content_Bible').hidden = true;
      document.getElementById('content_effect').hidden = true;
      document.getElementById('content_news').hidden = true;
        
      document.getElementById('content_input').hidden = true;
      document.getElementById('content_slide_1').hidden = true;
      document.getElementById('content_slide_2').hidden = true;
      document.getElementById('content_slide_3').hidden = true;
      
      document.getElementById("div_song").style.background = "rgb(0,112,0)";
      document.getElementById("div_Bible").style.background = "rgb(0,112,0)";
      document.getElementById("div_effect").style.background = "rgb(0,112,0)";
      document.getElementById("div_news").style.background = "rgb(0,112,0)";
      document.getElementById("div_slide1").style.background = "rgb(0,112,0)";
      document.getElementById("div_slide2").style.background = "rgb(0,112,0)";
      document.getElementById("div_slide3").style.background = "rgb(0,112,0)";
      document.getElementById("div_empty").style.background = "rgb(0,112,0)";
        
      switch(idx) {
        case 'song':
          document.getElementById("div_song").style.background = "rgb(0,128,0)";
          document.getElementById('content_song').hidden = false;
          document.getElementById('frame_song').focus();
          break;
        case 'Bible':
          document.getElementById("div_Bible").style.background = "rgb(0,128,0)";
          document.getElementById('content_Bible').hidden = false;
          document.getElementById('frame_Bible').focus();
          break;
        case 'effect':
          document.getElementById("div_effect").style.background = "rgb(0,128,0)";
          document.getElementById('content_effect').hidden = false;
          document.getElementById('frame_effect').focus();
          break;
        case 'news':
          document.getElementById("div_news").style.background = "rgb(0,128,0)";
          document.getElementById('content_news').hidden = false;
          document.getElementById('frame_news').focus();
          break;
        case 'slide1':
          document.getElementById("div_slide1").style.background = "rgb(0,128,0)";
          if (ppt[1].length == 0) {
            document.getElementById('content_input').hidden = false;
            document.getElementById('content_input').focus();
            document.getElementById("ppt_url").select();
          } else {
            document.getElementById('content_slide_1').hidden = false;
            document.getElementById('frame_slide_1').focus();
          }
          break;
        case 'slide2':
          document.getElementById("div_slide2").style.background = "rgb(0,128,0)";
          if (ppt[2].length == 0) {
            document.getElementById('content_input').hidden = false;
            document.getElementById('content_input').focus();
            document.getElementById("ppt_url").select();
          } else {
            document.getElementById('content_slide_2').hidden = false;
            document.getElementById('frame_slide_2').focus();
          }
          break;
        case 'slide3':
          document.getElementById("div_slide3").style.background = "rgb(0,128,0)";
          if (ppt[3].length == 0) {
            document.getElementById('content_input').hidden = false;
            document.getElementById('content_input').focus();
            document.getElementById("ppt_url").select();//.value;//String.fromCodePoint(0x1F604);
          } else {
            document.getElementById('content_slide_3').hidden = false;
            document.getElementById('frame_slide_3').focus();
          }
          break;
        default:
          break;
      }
    
}

switchFunction('song');

var keylock = false;
window.addEventListener('keyup', function(e) {

  if (e.keyCode == 16) keylock = false;
  
}, false);

window.addEventListener('keydown', function(e) {

  if (e.keyCode == 16) keylock = true;

}, false);


</script>
