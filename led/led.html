<script type="text/javascript" src="led.js" charset="UTF-8"></script>
<script type="text/javascript" src="anim.js" charset="UTF-8"></script>
<script type="text/javascript" src="ledmarquee.js" charset="UTF-8"></script>
<script type="text/javascript" src="clock.js" charset="UTF-8"></script>
<!DOCTYPE html>
<html>

<head>
    <meta name="viewport"
        content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height"
        charset="UTF-8" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=LXGW+WenKai+Mono+TC&family=Mochiy+Pop+One&family=Noto+Serif+TC:wght@200..900&family=Shippori+Antique+B1&display=swap" rel="stylesheet">
    <!--meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8"-->
    <style>
        body {
            margin: 0px;
            height: 100%;
            background-color: rgb(104, 104, 104);
            color: #00ff00;
            /*cursor:none;*/
        }
        button {
            font-size: 48px;
            background-color: rgb(100, 100, 100);
            color: #ffffff;
            /*margin: 2% 2%;*/
            /*width:45%;*/
            /*border: 1px solid;*/
            vertical-align: middle;
        }

        .slides {
            position: fixed;
            top: 10%;
            left: 40%;
            /* åˆå§‹ä½ç½®åœ¨å·¦ä¾§å±å¹•å¤– */
            width: 55%;
            height: 70%;
            background-color: rgb(0, 0, 0);
            color: #fff;
            transition: top 0.3s;
            /* æ·»åŠ è¿‡æ¸¡æ•ˆæœ */
            z-index: 90;
            border: none;
        }

        .leftmargin {
            content: "";
            position: absolute;
            left: -20px;
            /* è°ƒæ•´è¿™ä¸ªå€¼æ¥æ§åˆ¶åŒºåŸŸè·ç¦» div å·¦è¾¹çš„è·ç¦» */
            top: 0;
            width: 30px;
            /* åŒºåŸŸçš„å®½åº¦ */
            height: 100%;
            /* åŒºåŸŸçš„é«˜åº¦ï¼Œè¿™é‡Œå‡è®¾å’Œå†…å®¹ div ä¸€æ ·é«˜ */
            background-color: red;
            /* åŒºåŸŸçš„èƒŒæ™¯é¢œè‰² */
        }
    </style>
</head>

<body>

    <canvas id="canvas" width="100" height="100"></canvas>

    <blockquote>
        <div id="ui" hidden="true">
            <!-- <div class="leftmargin" id="left" hidden="false"></div> -->
            <hr size="8" align="left" width="33%" color="#aaaaaa">
            <div class="slides" id="slidesDiv" hidden="true">
                <iframe style="border: none;" width="100%" height="100%" id="slidesFrame"></iframe>
            </div>
            <p></p>
            LEDé¢æ¿åƒæ•¸:
            <button type="button" onclick="urlGo('led_url')">é è¦½</button>&nbsp;
            <button type="button" onclick="copyToClickBoard('led_url')">è¤‡è£½ç¶²å€</button>
            <p></p>
            <textarea style="border: none;font-size: 24px;" id="led_url" rows="10" cols="40"></textarea><br />
            <hr size="8" align="left" width="33%" color="#aaaaaa">
            <p></p>
            anim=
            <blockquote>
                <li>0 ç„¡å‹•ç•«</li>
                <li>1 åœˆåœˆ</li>
                <li>2 æ˜Ÿç©ºIn</li>
                <li>3 æ˜Ÿç©ºOut</li>
                <li>4 æ˜Ÿç©ºInout</li>
                <li>5 æ˜Ÿç©ºåœˆåœˆ</li>
                <li>6 ä¸‹é›ª</li>
                <li>7 ç…™ç«</li>
                <li>8 èˆå°</li>
                <li>9 æ™‚é˜</li>
                <li>10 è€é›»è…¦</li>
            </blockquote>
            <p></p>
            round=
            <blockquote>
                <li>0 æ–¹å½¢LED</li>
                <li>1 åœ“å½¢LED</li>
            </blockquote>
            <p></p>
            color1, color2 = rgb(ç´…0-255, ç¶ 0-255, è—0-255)
            <p></p>
            str1 : å­—ä¸²ä¸Š <br />
            str2 : å­—ä¸²ä¸‹
            <p></p>
            mtype1, mtype2
            <blockquote>
                <li>1 å·¦å³</li>
                <li>2 ç”±å³è‡³å·¦</li>
            </blockquote>
        </div>
    </blockquote>
</body>

</html>

<script type="text/javascript" src="../common.js" charset="UTF-8"></script>
<script type="text/javascript" charset="UTF-8">
    //canvas
    function _initData() {

        let _all = Math.max(7, Math.floor(window.innerHeight / 50));
        dots = Math.ceil(_all * 0.7);
        side = Math.max(1, _all - dots);

        //side = 3;
        //dots = 4;

        makeRound = readParam('round') == 1 ? true : false;

        swing = readParam('mtype1') === '1' ? 1 : 0;
        swing1 = readParam('mtype2') === '1' ? 1 : 0;

        speed = 300;
        color_0 = readParam('color1') != null ? readParam('color1') : "rgb(255, 255, 50)";

        speed1 = 150;
        color_1 = readParam('color2') != null ? readParam('color2') : "rgb(255, 50, 50)";

        animIdx = readParam('anim') != null ? parseInt(readParam('anim')) : 7;//parseInt(sel_anim.options[sel_anim.options.selectedIndex].value, 10);
        bgIdx = 0;

        subtitle[1] = readParam('str1') != null ? [readParam('str1')] : [''];//["å¾æ­²é¦–åˆ°å¹´çµ‚ è€¶å’Œè¯ ä½ ç¥çš„çœ¼ç›®æ™‚å¸¸çœ‹é¡§é‚£åœ°"];//[ç”³11:12]
        //let cons = "ğŸ‰æ–°å¹´å¿«æ¨‚ğŸ‰";
        subtitle[2] = readParam('str2') != null ? [readParam('str2')] : [''];

        init();
        initAnim();

        window.scroll(0, 0);

        //led.html?color1=rgb(255,80,80)&color2=rgb(80,255,80)&mtype1=1&mtype2=0&str1=2024æ–°å¹´å¿«æ¨‚&str2=å¾æ­²é¦–åˆ°å¹´çµ‚ è€¶å’Œè¯ ä½ ç¥çš„çœ¼ç›®æ™‚å¸¸çœ‹é¡§é‚£åœ°&anim=7
    }

    function getTouchPos(canvasDom, touchEvent) {
        var rect = canvasDom.getBoundingClientRect();
        return {
            x: touchEvent.touches[0].clientX - rect.left,
            y: touchEvent.touches[0].clientY - rect.top
        };
    }

    const controlRatio = 0.2;

    function touchAction(_x, _y) {
        if (_x < canvas.width * controlRatio && _y > canvas.height * (1 - controlRatio)) { //å·¦ä¸‹
            canvas.requestFullscreen();
            return;
        }
        if (_x > canvas.width * (1 - controlRatio) && _y < canvas.height * controlRatio) { //å³ä¸Š
            keepLEDGoing = keepLEDGoing == 0 ? 1 : 0;
        }
    }

    //ui
    const LEDURL = 'https://proj.tpcaog.org.tw/led/led.html?color1=rgb(255,80,80)&color2=rgb(80,255,80)&mtype1=1&mtype2=0&str1=å­—ä¸²ä¸ŠğŸ‰&str2=ğŸ˜€å­—ä¸²ä¸‹ğŸ˜&anim=7&round=0';

    function urlGo(id) {
        let value = document.getElementById(id).value;
        value = value.trim();
        if (value.length == 0) return;
        embeddedUrl(value);

        //window.location.href = value;
    }

    function embeddedUrl(url) {
        document.getElementById('slidesDiv').hidden = false;
        let frame = document.getElementById('slidesFrame');
        frame.src = url;
    }

    function copyToClickBoard(id) {
        var content = document.getElementById(id).value;
        copyToBoard(encodeURI(content));
    }

    var currentURL = window.location.href;
    console.log(currentURL);
    if (currentURL.endsWith('led.html')) {
        document.getElementById("led_url").value = LEDURL;
        document.getElementById("ui").hidden = false;
        document.getElementById("canvas").hidden = true;
    } else {
        _initData();
        window.addEventListener('resize', function () {//init();//initAnim();
            _initData();
        });
        canvas.addEventListener("touchend" /*"touchstart"*/, function (evt) {
            //evt.preventDefault();
            var touches = getTouchPos(canvas, evt);
            touchAction(touches.x, touches.y);
        });
        canvas.addEventListener('mousedown', (e) => {
            touchAction(e.x, e.y);
        });
    }

</script>