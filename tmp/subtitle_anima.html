
<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <style>
      body {
        margin: 0px;
        height: 100%;
        background-color:rgb(112, 112, 112);
      }
      main {
        position: fixed;
        width: 100%;
        height: 100%;
      }
      ::-webkit-scrollbar {
        display: none;
      }
    </style>
    </head>   
<body>

  <canvas id="canvas" width="100" height="100"></canvas>

</body>
</html>

<script type="text/javascript" charset="UTF-8">

function init() {
    canvas = document.getElementById("canvas");
    canvas.width  = window.innerWidth;
    canvas.height = window.innerHeight;
}

function prepareImage() {
  img = new Image();
  img.src = imgurl;
  img.onload = function() {};
}

function repaint() {

  var c = document.getElementById("canvas");
  var ctx = c.getContext("2d");

  ctx.clearRect(0, 0, c.width, c.height);

  ctx.fillStyle = 'green';
  ctx.fillRect(0, 0, c.width, c.height);

}

function canvasResize() {
  init();
  repaint();
}

function handleStart(evt) {
  sequencePick();
}

/*
function touchevent() {
  var el = document.getElementsByTagName("canvas")[0];
  el.addEventListener("touchstart", handleStart, false);  
  //el.addEventListener("touchend", handleEnd, false);
  //el.addEventListener("touchcancel", handleCancel, false);
  //el.addEventListener("touchmove", handleMove, false);
}
*/

function mouse(e) {
  //randomPick();
  sequencePick();
  return false;
}

window.addEventListener('resize', canvasResize);
window.addEventListener('mousedown', mouse, false);
document.getElementsByTagName("canvas")[0].addEventListener("touchstart", handleStart, false);


canvasResize();

function newParticle_skylight_background() {
  let p = {
    initial: function (c) { },
    release: function() { },
    update: function (c, _ctx, dt) {

      var grd = _ctx.createLinearGradient(0, 0, c.width, c.height);
      grd.addColorStop(0, 'rgb(200, 128, 0,1.0)');
      grd.addColorStop(1, 'rgb(0,0,0,1.0)');

      // Fill with gradient
      _ctx.fillStyle = grd;
      _ctx.fillRect(0, 0, c.width, c.height);
    }
  };
  return p
}

function newParticle_skylight() {
  let p = {
    x_stt: 0,
    y_stt: 0,
    x_end: 0,
    y_end: 0,
    R: 0,
    G: 0,
    B: 0,
    A: 0,
    radius:10,
    t:0,
    elapse:0,
    background: function() {

    },
    release: function() { },
    easein:function(_t) {
      return _t * _t * _t;
    },
    easeout:function(_t) {
      return -_t * _t + 2 * _t;
    },
    initial: function (c) {
      
      let short = Math.min(c.width, c.height);
      let long = Math.max(c.width, c.height);
      let range = (Math.random() * short * 0.1);
      let dir = (10 + Math.random() * 70) * Math.PI/180;
      
      this.x_stt = -2 * range + range * Math.cos(dir);
      this.y_stt = -2 * range + range * Math.sin(dir);
      
      this.x_end = -range + long * Math.cos(dir);
      this.y_end = -range + long * Math.sin(dir);
      
      this.R = 200 + 55 * Math.random();
      this.G = 50 + 100 * Math.random();
      this.B = 0;
      this.A = 1.0;//0.5 + Math.random()/2.0;

      this.radius = 10 + Math.random() * 10;
      this.elapse = 10 + (1-this.radius/20) * 10.0;
      this.t = Math.random() * this.elapse ;

    },
    update: function (c, _ctx, dt) {

      this.t += dt/1000.0;
      let ein = this.t/this.elapse;
      let x = this.x_stt + (this.x_end - this.x_stt) * ein;
      let y = this.y_stt + (this.y_end - this.y_stt) * ein;
      this.A = 1.0 + (0-1.0) * ein;
      let r = this.radius/2 * (1 + ein);
      //if (r < 0) r = this.radius;
      //ctx.save();
      _ctx.fillStyle = 'rgb(' + this.R + ',' + this.G + ',' + this.B + ',' + this.A + ')';//"rgb(0,0,200)";
      //ctx.fillRect (this.x - this.radius/2.0, this.y - this.radius/2.0, this.radius, this.radius);
      _ctx.beginPath();
      _ctx.arc(x, y, r, 0, 2 * Math.PI, true);
      _ctx.fill();
      if (this.t > this.elapse) {
        this.initial(c);
        this.t = 0;
      }
    }
  }
  return p;
}

function newParticle_snow() {
  let p = {
    x: 0,
    y: 0,
    v: 100,
    R: 0,
    G: 0,
    B: 0,
    A: 0,
    radius:10,
    release: function() { },
    initial: function (c) {
      
      let short = Math.min(c.width, c.height);
      let range = short * 0.4 + (Math.random() * short * 0.1) * (Math.random() >0.5?1:-1);
      let angle = Math.random() * 360 * Math.PI/180;
      this.x = c.width * (0.1 + Math.random() * 0.8);// + range * Math.cos(angle);
      this.y = -Math.random() * c.height * 0.2;
      let gray = 50 + 50 * Math.random();
      this.R = gray;
      this.G = gray;
      this.B = gray;
      this.A = 0.3 + Math.random() * 0.7;//0.3 - 1.0 
      this.radius = 0.05 * c.width * ((1 - this.A) + 0.1); //0.7 - 0
      this.v = 10 * this.radius;

    },
    update: function (c, _ctx, dt) {

      this.x = this.x + (-0.15 + Math.random() * 0.3) * dt;
      this.y = this.y + 0.001 * this.v * dt;
      //ctx.save();
      _ctx.fillStyle = 'rgb(' + this.R + ',' + this.G + ',' + this.B + ',' + this.A + ')'; //"rgb(0,0,200)";
      //ctx.fillRect (this.x - this.radius/2.0, this.y - this.radius/2.0, this.radius, this.radius);
      _ctx.beginPath();
      _ctx.arc(this.x, this.y, this.radius, 0, 2 * Math.PI, true);
      _ctx.fill();
      

      //ctx.restore();
      this.A = this.A - dt * 0.0002;

      if (this.A < 0.01) {
        this.initial(c);
      }
    }
  }
  return p;
}

function newParticle_sunrise_background() {
  let p = {
    initial: function (c) { },
    release: function() { },
    update: function (c, _ctx, dt) {

      var grd = _ctx.createLinearGradient(0, c.height/2, 0, 0);
      grd.addColorStop(0, 'rgb(255, 128, 0,1.0)');
      grd.addColorStop(1, 'rgb(0,0,0,1.0)');

      // Fill with gradient
      _ctx.fillStyle = grd;
      _ctx.fillRect(0, 0, c.width, c.height/2);

      grd = _ctx.createLinearGradient(0, c.height/2, 0, c.height);
      grd.addColorStop(0, 'rgb(255, 128, 0,1.0)');
      grd.addColorStop(1, 'rgb(0,0,0,1.0)');

      // Fill with gradient
      _ctx.fillStyle = grd;
      _ctx.fillRect(0, c.height/2 -1, c.width, c.height);

    }
  };
  return p
}

function newParticle_sunrise() {
  let p = {
    x_stt: 0,
    y_stt: 0,
    x_end: 0,
    y_end: 0,
    R: 0,
    G: 0,
    B: 0,
    A: 0,
    radius:10,
    t:0,
    elapse:0,
    release: function() { },
    easein:function(_t) {
      return _t * _t * _t;
    },
    easeout:function(_t) {
      return -_t * _t + 2 * _t;
    },
    initial: function (c) {
      /*
      let short = Math.min(c.width, c.height);
      let long = Math.max(c.width, c.height) * 0.5;
      let range = (Math.random() * short * 0.1);
      let dir = Math.random() * 360 * Math.PI/180;
      */
      this.x_stt = c.width * (0.2 + Math.random() * 0.6);
      if (Math.random() > 0.5) {

        this.y_stt = c.height/2 + (Math.random() * c.height * 0.01);

        this.x_end = -c.width * 0.2 + c.width * 1.4 * this.x_stt/c.width;
        this.y_end = this.y_stt + c.height * 0.1;

        if (Math.random > 0.4) {
          this.y_end = tthis.y_stt;
        }

      } else {

        this.y_stt = c.height/2 - (Math.random() * c.height * 0.01);

        this.x_end = -c.width * 0.2 + c.width * 1.4 * this.x_stt/c.width;
        this.y_end = this.y_stt - c.height * 0.1;

        if (Math.random > 0.4) {
          this.y_end = tthis.y_stt;
        }

      }
      
    
      this.R = 255;
      this.G = 128;
      this.B = 0;
      this.A = 1.0;//0.5 + Math.random()/2.0;

      this.radius = 3 + Math.random() * 5;
      this.elapse = Math.random() * 4;//1.0 + 4.0 * (70 - this.radius) /70;
      this.t = 0;

    },
    update: function (c, _ctx, dt) {

      this.t += dt/1000.0;
      let ein = this.t/this.elapse;
      let x = this.x_stt + (this.x_end - this.x_stt) * ein;
      let y = this.y_stt + (this.y_end - this.y_stt) * ein;
      this.A = 1.0 + (0 - 1.0) * ein;
      this.radius = this.radius + 0.002 * dt;
      //if (this.radius < 0) this.radius = 0;
      //ctx.save();
      _ctx.fillStyle = 'rgb(' + this.R + ',' + this.G + ',' + this.B + ',' + this.A + ')';//"rgb(0,0,200)";
      //ctx.fillRect (this.x - this.radius/2.0, this.y - this.radius/2.0, this.radius, this.radius);
      _ctx.beginPath();
      _ctx.arc(x, y, this.radius, 0, 2 * Math.PI, true);
      _ctx.fill();
      if (this.t > this.elapse) {
        this.initial(c);
        this.elapse = 3 + Math.random();
      }
    }
  }
  return p;
}

function newParticle_casual() {
  let p = {
    x: 0,
    y: 0,
    v:100,
    R: 0,
    G: 0,
    B: 0,
    A: 0,
    radius:10,
    dir:0,
    release: function() { },
    initial: function (c) {
      
      let short = Math.min(c.width, c.height);
      let range = short * 0.4 + (Math.random() * short * 0.1) * (Math.random() >0.5?1:-1);
      let angle = Math.random() * 360 * Math.PI/180;
      this.x = c.width/2 + range * Math.cos(angle);
      this.y = c.height/2 + range * Math.sin(angle);
      this.v = 30 + Math.random() * 30; 
      this.R = 100 + 155 * Math.random();
      this.G = 100 + 155 * Math.random();
      this.B = 100 + 155 * Math.random();
      this.A = Math.random();//0.5 + Math.random()/2.0;
      this.radius = 10 + Math.random() * 10;
      this.dir = Math.random() * 360 * Math.PI/180;

    },
    update: function (c, _ctx, dt) {

      this.x = this.x + this.v * dt * 0.001 * Math.cos(this.dir);
      this.y = this.y + this.v * dt * 0.001 * Math.sin(this.dir);
      //ctx.save();
      _ctx.fillStyle = 'rgb(' + this.R + ',' + this.G + ',' + this.B + ',' + this.A + ')'; //"rgb(0,0,200)";
      //ctx.fillRect (this.x - this.radius/2.0, this.y - this.radius/2.0, this.radius, this.radius);
      _ctx.beginPath();
      _ctx.arc(this.x, this.y, this.radius, 0, 2 * Math.PI, true);
      _ctx.fill();
      
      //ctx.restore();
      
      this.A = this.A - 0.3 * dt * 0.001;
      if (this.A < 0.01) {
        this.initial(c);
        this.A = 0.5 + Math.random()/2.0;
        //this.A = 0.5 + Math.random()/2.0;
      }
      //console.log(this.y + ', ' + this.x + ':' + dt);
    }
  }
  return p;
}

function newParticle_in() {
  let p = {
    x_stt: 0,
    y_stt: 0,
    x_end: 0,
    y_end: 0,
    R: 0,
    G: 0,
    B: 0,
    A: 0,
    radius:10,
    t:0,
    elapse:0,
    release: function() { },
    easein:function(_t) {
      return _t * _t * _t;
    },
    easeout:function(_t) {
      return -_t * _t + 2 * _t;
    },
    initial: function (c) {
      
      let short = Math.min(c.width, c.height);
      let long = Math.max(c.width, c.height) * 0.5;
      let range = (Math.random() * short * 0.1);
      let dir = Math.random() * 360 * Math.PI/180;
      
      this.x_stt = c.width/2 + range * Math.cos(dir);
      this.y_stt = c.height/2 + range * Math.sin(dir);
      
      this.x_end = c.width/2 + long * Math.cos(dir);
      this.y_end = c.height/2 + long * Math.sin(dir);
      
      this.R = 100 + 155 * Math.random();
      this.G = 100 + 155 * Math.random();
      this.B = 100 + 155 * Math.random();
      this.A = 1.0;//0.5 + Math.random()/2.0;

      this.radius = 20 + Math.random() * 50;
      this.elapse = 1.0 + 4.0 * (70 - this.radius) /70;
      this.t = 0;

    },
    update: function (c, _ctx, dt) {

      this.t += dt/1000.0;
      let ein = this.easein(this.t/this.elapse);
      let x = this.x_stt + (this.x_end - this.x_stt) * ein;
      let y = this.y_stt + (this.y_end - this.y_stt) * ein;
      this.A = 1.0 + (0-1.0) * ein;
      let r = 0.0 + (this.radius - 0) * ein;
      if (r < 0)
        r = this.radius;
      //ctx.save();
      _ctx.fillStyle = 'rgb(' + this.R + ',' + this.G + ',' + this.B + ',' + this.A + ')';//"rgb(0,0,200)";
      //ctx.fillRect (this.x - this.radius/2.0, this.y - this.radius/2.0, this.radius, this.radius);
      _ctx.beginPath();
      _ctx.arc(x, y, r, 0, 2 * Math.PI, true);
      _ctx.fill();
      if (this.t > this.elapse) {
        this.initial(c);
      }
    }
  }
  return p;
}

function newParticle_out() {
  let p = {
    x_stt: 0,
    y_stt: 0,
    x_end: 0,
    y_end: 0,
    R: 0,
    G: 0,
    B: 0,
    A: 0,
    radius:10,
    t:0,
    elapse:0,
    release: function() { },
    easein:function(_t) {
      return _t * _t * _t;
    },
    easeout:function(_t) {
      return -_t * _t + 2 * _t;
    },
    initial: function (c) {
      
      let short = Math.min(c.width, c.height);
      let long = Math.max(c.width, c.height) * 0.5;
      let range = (Math.random() * short * 0.1);
      let dir = Math.random() * 360 * Math.PI/180;
      
      this.x_end = c.width/2 + range * Math.cos(dir);
      this.y_end = c.height/2 + range * Math.sin(dir);
      
      this.x_stt = c.width/2 + long * Math.cos(dir);
      this.y_stt = c.height/2 + long * Math.sin(dir);
      
      this.R = 100 + 155 * Math.random();
      this.G = 100 + 155 * Math.random();
      this.B = 100 + 155 * Math.random();
      this.A = 1.0;//0.5 + Math.random()/2.0;

      this.radius = 20 + Math.random() * 50;
      this.elapse = 1.0 + 4.0 * (70 - this.radius) /70;
      this.t = 0;

    },
    update: function (c, _ctx, dt) {

      this.t += dt/1000.0;
      let ein = this.easeout(this.t/this.elapse);
      let x = this.x_stt + (this.x_end - this.x_stt) * ein;
      let y = this.y_stt + (this.y_end - this.y_stt) * ein;
      this.A = 0 + (1.0 - 0) * ein;
      let r = this.radius + (0 - this.radius) * ein;
      if (r < 0)
        r = this.radius;
      //ctx.save();
      _ctx.fillStyle = 'rgb(' + this.R + ',' + this.G + ',' + this.B + ',' + this.A + ')';//"rgb(0,0,200)";
      //ctx.fillRect (this.x - this.radius/2.0, this.y - this.radius/2.0, this.radius, this.radius);
      _ctx.beginPath();
      _ctx.arc(x, y, r, 0, 2 * Math.PI, true);
      _ctx.fill();
      if (this.t > this.elapse) {
        this.initial(c);
      }
    }
  }
  return p;
}

function newParticle_ring() {
  let p = {
    type:  0,
    x_stt: 0,
    y_stt: 0,
    x_end: 0,
    y_end: 0,
    R: 0,
    G: 0,
    B: 0,
    A: 0,
    radius:10,
    t:0,
    elapse:0,
    release: function() { },
    easein:function(_t) {
      return _t * _t * _t;
    },
    easeout:function(_t) {
      return -_t * _t + 2 * _t;
    },
    initial: function (c) {
      
      let short = Math.min(c.width, c.height);
      let long = Math.max(c.width, c.height) * 0.5;
      let range = (Math.random() * short * 0.1);
      let dir = Math.random() * 360 * Math.PI/180;
      
      if (this.type == 0) {
        this.x_stt = c.width/2 + (short * 0.05 + range) * Math.cos(dir);
        this.y_stt = c.height/2 + (short * 0.05 + range) * Math.sin(dir);
      
        this.x_end = c.width/2 + long * Math.cos(dir);
        this.y_end = c.height/2 + long * Math.sin(dir);  
        
      } else {

        this.x_end = c.width/2 + (short * 0.05 + range) * Math.cos(dir);
        this.y_end = c.height/2 + (short * 0.05 + range) * Math.sin(dir);
      
        this.x_stt = c.width/2 + long * Math.cos(dir);
        this.y_stt = c.height/2 + long * Math.sin(dir);
      }
      
      this.R = 100 + 155 * Math.random();
      this.G = 100 + 155 * Math.random();
      this.B = 100 + 155 * Math.random();
      this.A = 1.0;//0.5 + Math.random()/2.0;

      this.radius = 20 + Math.random() * 50;
      this.elapse = 1.0;//1.0 + 4.0 * (70 - this.radius) /70;
      this.t = 0;

    },
    update: function (c, _ctx, dt) {

      this.t += dt/1000.0;
      let ein = this.type == 0?this.easein(this.t/this.elapse):this.easeout(this.t/this.elapse);
      let x = this.x_stt + (this.x_end - this.x_stt) * ein;
      let y = this.y_stt + (this.y_end - this.y_stt) * ein;
      if (this.type == 0)
        this.A = 1.0 + (0-1.0) * ein;
      else 
        this.A = 0.0 + (1.0 - 0) * ein;
      let r = 0.0 + (this.radius - 0) * ein;
      if (this.type == 1)
        r = this.radius + (0 - this.radius) * ein;
      if (r < 0) r = 0;
      //ctx.save();
      _ctx.fillStyle = 'rgb(' + this.R + ',' + this.G + ',' + this.B + ',' + this.A + ')';//"rgb(0,0,200)";
      //ctx.fillRect (this.x - this.radius/2.0, this.y - this.radius/2.0, this.radius, this.radius);
      _ctx.beginPath();
      _ctx.arc(x, y, r, 0, 2 * Math.PI, true);
      _ctx.fill();
      
      if (this.t > this.elapse) {
        this.type = this.type == 0?1:0;
        this.initial(c);
      }

    }
  }
  return p;
}

function newParticle_firework_particle() {
  let p = {
    x_stt: 0,
    y_stt: 0,
    x_end: 0,
    y_end: 0,
    R: 0,
    G: 0,
    B: 0,
    A: 0,
    radius:10,
    t:0,
    elapse:0,
    easein:function(_t) {
      return _t * _t * _t;
    },
    easeout:function(_t) {
      return -_t * _t + 2 * _t;
    },
    easeinout:function(_t) {
      //console.log('sin('+ _t * Math.PI+(') = '+Math.sin(_t * Math.PI)));
      return Math.sin(_t * Math.PI);
    },
    release: function() { },
    colorDis: function(idx) {
      let r0 = 155 * Math.random();
      let r1 = 155 * Math.random();
      let rc0 = 200 + 55 * Math.random();
      let rc1 = 200 + 55 * Math.random();
      switch(idx) {
        case 0: this.R = rc0; this.G =  r0; this.B =  r1;  break;
        case 1: this.R =  r0; this.G = rc0; this.B =  r1;  break;
        case 2: this.R =  r0; this.G =  r1; this.B = rc0;  break;
        case 3: this.R =  r0; this.G = rc0; this.B = rc1;  break;
        case 4: this.R = rc0; this.G =  r0; this.B = rc1;  break;
        case 5: this.R = rc0; this.G = rc1; this.B =  r0;  break;
      }
    },
    initial: function (c, _x, _y, _range, _elapse, idx) {
      
      let r0 = Math.random();
      while (Math.random() > r0/2.0) r0 = Math.random();
      let range = r0 * _range;

      let dir = Math.random() * 360 * Math.PI/180;
      
      this.x_stt = _x;// + (short * 0.05 + range) * Math.cos(dir);
      this.y_stt = _y;//c.height/2;// + (short * 0.05 + range) * Math.sin(dir);
      
      this.x_end = this.x_stt + range * Math.cos(dir);
      this.y_end = this.y_stt + range * Math.sin(dir);
      
      this.colorDis(idx);
      
      this.A = 1.0;//0.5 + Math.random()/2.0;
      
      this.radius = 6 + 4 * (1- range/_range);// + Math.random() * 50;
      this.elapse = _elapse;
      this.t = 0;

    },
    update: function (c, _ctx, dt) {

      this.t += dt/1000.0;
      let eout = this.easeout(this.t/this.elapse);
      let x = this.x_stt + (this.x_end - this.x_stt) * eout;
      let y = this.y_stt + (this.y_end - this.y_stt) * eout;
      //console.log('t:' + this.t/this.elapse);
      this.A = this.easeinout(this.t/this.elapse);
      let r = 0.0 + (this.radius - 0) * eout;
      if (r < 0) r = 0;
      //ctx.save();
      _ctx.fillStyle = 'rgb(' + this.R + ',' + this.G + ',' + this.B + ',' + this.A + ')';//"rgb(0,0,200)";
      //ctx.fillRect (this.x - this.radius/2.0, this.y - this.radius/2.0, this.radius, this.radius);
      _ctx.beginPath();
      _ctx.arc(x, y, r, 0, 2 * Math.PI, true);
      _ctx.fill();
      
      if (this.t > this.elapse) {
        this.t = this.elapse;
      }
    }
  }
  return p;
}

function newParticle_firework() {
  let p = {
    particles:[],
    
    t:0,
    elapse:0,
    initial: function (c) {
      
      let x = c.width * (0.2 + Math.random() * 0.6);// + (short * 0.05 + range) * Math.cos(dir);
      let y = c.height * (0.2 + Math.random() * 0.6);
      let range = Math.max(c.width, c.height) * 0.2 * (0.5 + Math.random()/2.0);

      this.elapse = 0.7 + Math.random()/2.0;//1.0 + 4.0 * (70 - this.radius) /70;
      this.t = 0;

      if (this.particles.length < 1) {
        for (var i = 0;i<80;i++) {
          this.particles[i] = newParticle_firework_particle();
        }
      }

      let idx = Math.floor(Math.random() * 6);
      
      for (var i = 0;i<this.particles.length;i++) {
        this.particles[i].initial(c, x, y, range, this.elapse, idx);
      }

    },
    release: function() {
      this.particles.length = 0;
      this.particles = [];
    },
    update: function (c, _ctx, dt) {

      this.t += dt/1000.0;

      for (var i = 0;i<this.particles.length;i++) {
        this.particles[i].update(c, _ctx, dt);
      }

      if (this.t > this.elapse) {
        this.initial(c);
      }
    }
  }
  return p;
}

function newParticle_rect() {
  let p = {
    x: 0,
    y: 0,
    v: 0,
    R: 0,
    G: 0,
    B: 0,
    A: 0,
    radius:10,
    release: function() { },
    initial: function (c) {
                  
      this.x = c.width * (0.2 + Math.random() * 0.6);
      this.y = c.height * (0.5 + Math.random() * 0.5);
      this.v = 0.2 + Math.random() * 0.5; 
      this.R = 155 * Math.random();
      this.G = 155 * Math.random();
      this.B = 155 * Math.random();
      this.A = 0.5 + Math.random() * 0.2;
      this.radius = 100 + Math.random() * 100;

    },
    update: function (c, _ctx, dt) {
      
      _ctx.fillStyle = 'rgb(' + this.R + ',' + this.G + ',' + this.B + ',' + this.A + ')'; //"rgb(0,0,200)";
      _ctx.fillRect (this.x - this.radius * 0.7, this.y - this.radius/2.0, this.radius * 1.4, this.radius);
      
      
      this.A = this.A - this.v * dt * 0.001;
      if (this.A < 0.01) {
        this.initial(c);
      }
      //console.log(this.y + ', ' + this.x + ':' + dt);
    }
  }
  return p;
}

function newClock() {
  let p = {
    release: function() { },
    initial: function (c) { },
    update: function (c, _ctx, dt) {
      
      var x = c.width/2.0;
      var y = c.height/2.0;
      var len = c.height/5.0;

      var date = new Date();

      //var n = d.getTime();
      //_ctx.font = "64px Arial";
      //_ctx.fillStyle = 'rgb(' + this.R + ',' + this.G + ',' + this.B + ',' + this.A + ')'; //"rgb(0,0,20)"
      //if (Math.random() > 0.5) _ctx.fillText(h + ':' + min +':' + s, this.x, this.y);

      let h = date.getHours() % 12;
      let min = date.getMinutes();
      let s = date.getSeconds();
      let ms = date.getMilliseconds();

      _ctx.strokeStyle = "rgb(100, 100, 100)";
      _ctx.lineWidth = 16;
      _ctx.beginPath();
      _ctx.arc(x, y, 2 * len + 10, 0, 2 * Math.PI, true);
      _ctx.stroke();

      _ctx.fillStyle = "rgb(100, 100, 100)";
      for (let i = 0;i<12;i++) {
        let angle = (90 - i * 360.0/12.0) * Math.PI/180;
        let dx = 2 * len * Math.cos(angle);
        let dy = -2 * len * Math.sin(angle);
        _ctx.beginPath();
        _ctx.arc(x + dx, y + dy, len/10, 0, 2 * Math.PI, true);
        _ctx.fill();
      }

      _ctx.lineCap = "round";

      let angle = (90 - (h + min/60.0) * 360.0/12.0) * Math.PI/180;
      let dx = 0.8 * len * Math.cos(angle);
      let dy = -0.8 * len * Math.sin(angle);
      
      _ctx.beginPath();
      _ctx.moveTo(x, y);
      _ctx.lineTo(x + dx, y + dy);
      _ctx.lineWidth = 40;
      _ctx.strokeStyle = "rgb(0, 0, 150)";
      _ctx.stroke();
      
      
      angle = (90 - (min + s/60.0) * 360.0/60.0) * Math.PI/180;
      dx = 1.5 * len * Math.cos(angle);
      dy = -1.5 * len * Math.sin(angle);

      _ctx.beginPath();
      _ctx.moveTo(x, y);
      _ctx.lineTo(x + dx, y + dy);
      _ctx.lineWidth = 20;
      _ctx.strokeStyle =  "rgb(120, 120, 0)";
      _ctx.stroke();
      
      let hz = 4 * 2;
      var gap = Math.floor(ms/(1000/hz));
      angle = (90 - (s + gap/hz) * 360.0/60.0) * Math.PI/180;
      //angle = (90 - (s + ms/1000.0) * 360.0/60.0) * Math.PI/180;
      dx = 1.7 * len * Math.cos(angle);
      dy = -1.7 * len * Math.sin(angle);

      _ctx.beginPath();
      _ctx.moveTo(x, y);
      _ctx.lineTo(x + dx, y + dy);
      _ctx.lineWidth = 10;
      _ctx.strokeStyle = "rgb(120, 0, 0)";
      _ctx.stroke();

      
      _ctx.beginPath();
      _ctx.fillStyle = "rgb(120, 0, 0)";
      _ctx.arc(x, y, 20, 0, 2 * Math.PI, true);
      _ctx.fill();

      _ctx.font = "32px Arial";
      _ctx.textAlign = "center";
      //_ctx.fillStyle = 'rgb(' + this.R + ',' + this.G + ',' + this.B + ',' + this.A + ')'; //"rgb(0,0,20)"
      _ctx.fillText((hz/2) + 'Hz', x, y + 64);
      
    }
  }
  return p;
}

/*
function newParticle_txt(sequence, total) {
  let p = {
    x: 0,
    y: 0,
  idx: 0,
  txt: "",
  size:0,
  seq:sequence,
  ttl:total,
  idxlen:0,
  elapse:0,
  gap : 0.1,
    release: function() {},
    initial: function (c) {
      

      let chapter = Math.floor(Math.random() * subtitle.length);
      let verse = Math.floor(Math.random() * subtitle[chapter].length);
      this.txt = subtitle[chapter][verse];

      //this.size = Math.floor(10 + (this.seq/this.ttl) * 20);
      this.size = 20 + 4 * Math.floor(this.seq/5);
      
      //console.log(':'+this.size);

      this.x = c.width * Math.random();
      this.y = Math.random() * c.height/2;
      this.idxlen = this.txt.length;//10 + 10 * Math.random();
      this.elapse = 0;
      this.idx = 0;
      this.gap = 0.05 + Math.random() * 0.1;
    },
    update: function (c, _ctx, dt) {
      
      

      /// + this.R + ',' + this.G + ',' + this.B + ',' + this.A + ')'; //"rgb(0,0,200)";
      //_ctx.fillRect (200 - 10, 200 - 10, 20, 20);
      
      //_ctx.save();
      
      _ctx.textAlign = "left";
      _ctx.font = this.size + "px 標楷體";

      

      //ctx.fillText(this.txt.substr(i, 1), this.x, this.y);

      this.elapse += dt * 0.001;
      if (this.elapse > this.gap) {
        this.idx++;
        if (this.idx - this.idxlen + 1 >= this.txt.length) {
          this.initial(c);
          return;
        }
        
        this.elapse = 0;
      } 

      let _len = this.idxlen;
      for (var i = this.idx;i>=0;i--) {
        if (i < 0) {
          break;
        }
        if (i < this.txt.length) {
          _ctx.fillStyle = 'rgb(0,255, 0, ' + (_len/this.idxlen) +')';
          if (i == this.idx)
            _ctx.fillStyle = 'rgb(150,255, 150, 1.0)';
          _ctx.fillText(this.txt.substr(i, 1), this.x, this.y + (i * this.size));
        }  
        _len--;
        if (_len == 0) 
          break;
      }
      
    }
  }
  return p;
}
*/

function anim_update(elapse) {

  var c = document.getElementById("canvas");
  var ctx = c.getContext("2d");

  ctx.clearRect(0, 0, c.width, c.height);

  ctx.fillStyle = 'black';
  ctx.fillRect(0, 0, c.width, c.height);

  let dt = elapse - pre;
  pre = elapse;
  
  for (var i = 0;i<particles.length;i++) {
    particles[i].update(c, ctx, dt);
  }
  window.requestAnimationFrame(anim_update);

}

function initAnim(idx) {

  var isinit = false;
  if (particles.length == 0) {
    isinit = true;
  }

  var c = document.getElementById("canvas");
  var ctx = c.getContext("2d");
  
  if (particles.length >= 1) {
    for (var i = 0;i<particles.length;i++) {
      particles[i].release();
    }
  }

  particles.length = 0;
  particles = [];

  if (idx == 0) {
    for (var i = 0;i<150;i++) {
      particles[i] = newParticle_casual();
      particles[i].initial(canvas);
    }
  } else if (idx == 1) {
    for (var i = 0;i<150;i++) {
      particles[i] = newParticle_in();
      particles[i].initial(canvas);
    }
  } else if (idx == 2) {
    for (var i = 0;i<150;i++) {
      particles[i] = newParticle_out();
      particles[i].initial(canvas);
    }
  } else if (idx == 3) {
    for (var i = 0;i<150;i++) {
      particles[i] = newParticle_ring();
      particles[i].initial(canvas);
    }
  } else if (idx == 4) {
    for (var i = 0;i<3;i++) {
      particles[i] = newParticle_firework();
      particles[i].initial(canvas);
    }
  } else if (idx == 5) {
    for (var i = 0;i<20;i++) {
      particles[i] = newParticle_rect();
      particles[i].initial(canvas);
    }
  } else if (idx == 6) {
    particles[0] = newClock();
    particles[0].initial(canvas);
  } else if (idx == 7) {
    particles[0] = newParticle_skylight_background();
    for (var i = 1;i<100;i++) {
      particles[i] = newParticle_skylight();//newParticle_snow();
      particles[i].initial(canvas);
    }
  } else if (idx == 8) {
    particles[0] = newParticle_sunrise_background();
    for (var i = 1;i<100;i++) {
      particles[i] = newParticle_sunrise();//();
      particles[i].initial(canvas);
    }
  } else if (idx == 9) {
    for (var i = 0;i<100;i++) {
      particles[i] = newParticle_snow();
      particles[i].initial(canvas);
    }
  }
  /* 
  else if (idx == 10) {
    for (var i = 0;i<30;i++) {
      particles[i] = newParticle_txt(i, 20);//();
      particles[i].initial(canvas);
    }
  }
  */
  if (isinit)
    window.requestAnimationFrame(anim_update);
}

function randomPick() {
  animidx = Math.floor(Math.random() * 10);
  initAnim(animidx);
}

function sequencePick() {
  animidx = (animidx + 1)%10;
  initAnim(animidx);
}

var animidx = Math.floor(Math.random() * 7);
var pre = 0;
var particles = [];

randomPick();

</script>
